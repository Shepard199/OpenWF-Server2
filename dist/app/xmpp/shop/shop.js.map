{"version":3,"sources":["../../../../src/app/xmpp/shop/shop.js"],"names":["parseXML","items","shopItems","i","length","item","id","expirationTime","durabilityPoints","repair_cost","quantity","name","item_category_override","offer_status","supplier_id","discount","rank","game_price","cry_price","crown_price","game_price_origin","cry_price_origin","crown_price_origin","key_item_name","key_item_price","client","stz","find","err","shop","parse","attrs","from","to","send"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,SAASA,QAAT,CAAkBC,KAAlB,EAAwB;AACtB,QAAIC,YAAY,EAAhB;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,MAAMG,MAA1B,EAAkCD,GAAlC,EAAuC;AACrC,YAAGF,MAAME,CAAN,CAAH,EAAY;AACV,gBAAGF,MAAME,CAAN,EAASE,IAAZ,EAAiB;AACfH,6BAAa,gBAAcD,MAAME,CAAN,EAASE,IAAT,CAAcC,EAA5B,GAA+B,oBAA/B,GAAoDL,MAAME,CAAN,EAASE,IAAT,CAAcE,cAAlE,GAAiF,sBAAjF,GAAwGN,MAAME,CAAN,EAASE,IAAT,CAAcG,gBAAtH,GAAuI,iBAAvI,GAAyJP,MAAME,CAAN,EAASE,IAAT,CAAcI,WAAvK,GAAmL,cAAnL,GAAkMR,MAAME,CAAN,EAASE,IAAT,CAAcK,QAAhN,GAAyN,UAAzN,GAAoOT,MAAME,CAAN,EAASE,IAAT,CAAcM,IAAlP,GAAuP,4BAAvP,GAAoRV,MAAME,CAAN,EAASE,IAAT,CAAcO,sBAAlS,GAAyT,kBAAzT,GAA4UX,MAAME,CAAN,EAASE,IAAT,CAAcQ,YAA1V,GAAuW,iBAAvW,GAAyXZ,MAAME,CAAN,EAASE,IAAT,CAAcS,WAAvY,GAAmZ,cAAnZ,GAAkab,MAAME,CAAN,EAASE,IAAT,CAAcU,QAAhb,GAAyb,UAAzb,GAAocd,MAAME,CAAN,EAASE,IAAT,CAAcW,IAAld,GAAud,gBAAvd,GAAwef,MAAME,CAAN,EAASE,IAAT,CAAcY,UAAtf,GAAigB,eAAjgB,GAAihBhB,MAAME,CAAN,EAASE,IAAT,CAAca,SAA/hB,GAAyiB,iBAAziB,GAA2jBjB,MAAME,CAAN,EAASE,IAAT,CAAcc,WAAzkB,GAAqlB,uBAArlB,GAA6mBlB,MAAME,CAAN,EAASE,IAAT,CAAce,iBAA3nB,GAA6oB,sBAA7oB,GAAoqBnB,MAAME,CAAN,EAASE,IAAT,CAAcgB,gBAAlrB,GAAmsB,wBAAnsB,GAA4tBpB,MAAME,CAAN,EAASE,IAAT,CAAciB,kBAA1uB,GAA6vB,mBAA7vB,GAAixBrB,MAAME,CAAN,EAASE,IAAT,CAAckB,aAA/xB,GAA6yB,oBAA7yB,GAAk0BtB,MAAME,CAAN,EAASE,IAAT,CAAcmB,cAAh1B,GAA+1B,KAA52B;AACD;AACF;AACF;AACD,WAAOtB,SAAP;AACD;;kBAEc,UAACuB,MAAD,EAASC,GAAT,EAAiB;AAC5B,oBAAKzB,KAAL,CAAW0B,IAAX,CAAgB,EAAhB,EAAoB,UAASC,GAAT,EAAc3B,KAAd,EAAqB;AACrC,YAAI4B,OAAO,cAAIC,KAAJ,CACP,aAAWJ,IAAIK,KAAJ,CAAUC,IAArB,GAA0B,UAA1B,GAAqCN,IAAIK,KAAJ,CAAUE,EAA/C,GAAkD,QAAlD,GAA2DP,IAAIK,KAAJ,CAAUzB,EAArE,GAAwE,kBAAxE,GACI,mCADJ,GAEQ,wDAFR,GAGYN,SAASC,KAAT,CAHZ,GAIQ,oBAJR,GAKI,UALJ,GAMA,OAPO,CAAX;AASAwB,eAAOS,IAAP,CAAYL,IAAZ;AACH,KAXD;AAYH,C","file":"shop.js","sourcesContent":["import Shop from '../../modules/shop/model';\nimport ltx from 'ltx';\n\nfunction parseXML(items){\n  let shopItems = '';\n  for (let i = 0; i < items.length; i++) {\n    if(items[i]){\n      if(items[i].item){\n        shopItems += '<offer id=\"'+items[i].item.id+'\" expirationTime=\"'+items[i].item.expirationTime+'\" durabilityPoints=\"'+items[i].item.durabilityPoints+'\" repair_cost=\"'+items[i].item.repair_cost+'\" quantity=\"'+items[i].item.quantity+'\" name=\"'+items[i].item.name+'\" item_category_override=\"'+items[i].item.item_category_override+'\" offer_status=\"'+items[i].item.offer_status+'\" supplier_id=\"'+items[i].item.supplier_id+'\" discount=\"'+items[i].item.discount+'\" rank=\"'+items[i].item.rank+'\" game_price=\"'+items[i].item.game_price+'\" cry_price=\"'+items[i].item.cry_price+'\" crown_price=\"'+items[i].item.crown_price+'\" game_price_origin=\"'+items[i].item.game_price_origin+'\" cry_price_origin=\"'+items[i].item.cry_price_origin+'\" crown_price_origin=\"'+items[i].item.crown_price_origin+'\" key_item_name=\"'+items[i].item.key_item_name+'\" key_item_price=\"'+items[i].item.key_item_price+'\"/>';\n      }\n    }\n  }\n  return shopItems;\n}\n\nexport default (client, stz) => {\n    Shop.items.find({}, function(err, items) {\n        let shop = ltx.parse(\n            \"<iq to='\"+stz.attrs.from+\"' from='\"+stz.attrs.to+\"' id='\"+stz.attrs.id+\"' type='result'>\"+\n                \"<query xmlns='urn:cryonline:k01'>\"+\n                    \"<shop_get_offers code='3' from='500' to='250' hash=''>\"+\n                        parseXML(items)+\n                    '</shop_get_offers>'+\n                \"</query>\"+\n            \"</iq>\"\n        )\n        client.send(shop); \n    });\n};"]}